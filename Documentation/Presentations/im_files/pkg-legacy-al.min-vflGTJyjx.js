define("modules/clean/react/dbox_app_promo",["require","exports","tslib","classnames","create-react-class","react","react-dom-factories","prop-types","modules/clean/react/button","modules/clean/react/image","modules/clean/static_urls"],(function(e,t,a,s,i,r,o,n,l,m,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),s=a.__importDefault(s),i=a.__importDefault(i),r=a.__importDefault(r),o=a.__importDefault(o),n=a.__importStar(n),l=a.__importStar(l),t.DboxAppFeatureList=void 0,t.DboxAppPromoSection=void 0;var d=r.default.createElement,p=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.render=function(){var e={"dbox-app-promo-container":!0};return this.props.className&&(e[this.props.className]=!0),o.default.div({className:s.default(e)},o.default.div({className:"dbox-app-promo-title"},this.props.title),o.default.div({className:"dbox-app-promo"},this.props.children))},t.displayName="DboxAppPromo",t.propTypes={title:n.string,className:n.string},t})(r.default.Component);t.DboxAppPromo=p;var c=i.default({displayName:"Actionable",propTypes:{handler:n.func,progressMapper:n.func},getDefaultProps:function(){return{handler:function(){},progressMapper:function(e,t){return{disabled:e||t.disabled}}}},getInitialState:function(){return{inProgress:!1}},onClick:function(){var e=this;if(!this.state.inProgress){var t="function"==typeof this.props.handler?this.props.handler():void 0;return t&&"function"==typeof t.complete?(this.setState({inProgress:!0}),t.complete((function(){if(e.isMounted())return e.setState({inProgress:!1})}))):void 0}},render:function(){var e,t={};for(var a in this.props)e=this.props[a],["handler","children","progressMapper"].includes(a)||(t[a]=e);t.onClick=this.onClick,t.inProgress=this.state.inProgress;var s=this.props.progressMapper(this.state.inProgress,t);for(var a in s)e=s[a],t[a]=e;return r.default.cloneElement(r.default.Children.only(this.props.children),t)}});t.Actionable=c;var _=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.render=function(){return o.default.div({className:"dbox-app-promo-banner"},o.default.div({className:"dbox-app-promo-banner-body"},o.default.div({className:"dbox-app-promo-banner-title"},this.props.title),o.default.div({className:"dbox-app-promo-banner-description"},this.props.description)),o.default.div({className:"dbox-app-promo-banner-buttons"},Array.from(this.props.buttons).map((function(e,t){return o.default.span({className:"dbox-app-promo-banner-button",key:"button-"+t},d(c,{handler:e.handler},d(l.button,{importance:"tertiary"},e.text)))}))),o.default.div({className:"clear"}))},t.displayName="DboxAppPromoBanner",t.propTypes={title:n.string,description:n.string,buttons:n.arrayOf(n.shape({text:n.string,handler:n.func}))},t})(r.default.Component);t.DboxAppPromoBanner=_;var f=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.render=function(){return o.default.div({className:"dbox-app-promo-3pane"},o.default.div({className:"dbox-app-promo-grid"},Array.from(this.props.columns).map((function(e,t){return o.default.div({className:"dbox-app-promo-grid-column",key:"c_"+t},e.imageSource&&e.imageSourceHiRes?o.default.div({className:"pane-image"},d(m.Image,{src:u.static_url(e.imageSource),srcHiRes:u.static_url(e.imageSourceHiRes)})):void 0,e.title?o.default.div({className:"pane-title"},e.title):void 0,o.default.div({className:"pane-text"},e.text))}))))},t.displayName="DboxAppPromoGrid",t.propTypes={columns:n.arrayOf(n.shape({title:n.string,text:n.string,imageSource:n.string,imageSourceHiRes:n.string}))},t.defaultProps={columns:[]},t})(r.default.Component);t.DboxAppPromoGrid=f;var E=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.render=function(){var e=s.default({"dbox-app-promo-image-text-pane":!0,"dbox-app-promo-image-text-image-pane":!0,"primary-position":this.props.isImagePrimary,"secondary-position":!this.props.isImagePrimary}),t=s.default({"dbox-app-promo-image-text-pane":!0,"dbox-app-promo-image-text-content-pane":!0,"primary-position":!this.props.isImagePrimary,"secondary-position":this.props.isImagePrimary});return o.default.div({className:"dbox-app-promo-image-text"},o.default.div({className:e},d(m.Image,{src:u.static_url(this.props.imageSource),srcHiRes:u.static_url(this.props.imageSourceHiRes)})),o.default.div({className:t},o.default.div({className:"dbox-app-promo-image-text-title"},this.props.title),o.default.div({className:"dbox-app-promo-image-text-text"},this.props.text,this.props.children)),o.default.div({className:"clear"}))},t.displayName="DboxAppPromoImageText",t.propTypes={imageSource:n.string,imageSourceHiRes:n.string,title:n.string,text:n.string,isImagePrimary:n.bool},t.defaultProps={isImagePrimary:!0},t})(r.default.Component);t.DboxAppPromoImageText=E})),define("modules/clean/teams/constants",["require","exports","modules/core/i18n"],(function(e,t,a){"use strict";var s,i;Object.defineProperty(t,"__esModule",{value:!0}),t.ADMIN_ROLE={SUPER:0,USER_MANAGEMENT:1,HELPDESK:2,CUSTOM:3,LIMITED:4,NONE:-1},t.ADMIN_ROLE_NAMES={0:a.intl.formatMessage({id:"vdPwYR",defaultMessage:"Team Admin"}),1:a.intl.formatMessage({id:"NyU163",defaultMessage:"User Management Admin"}),2:a.intl.formatMessage({id:"CgpQgI",defaultMessage:"Support Admin"}),3:a.intl.formatMessage({id:"J/vDSM",defaultMessage:"Custom Admin"}),4:a.intl.formatMessage({id:"GPrFxQ",defaultMessage:"Limited Admin"})},t.TEAM_MEMBERSHIP_TYPES={FULL:0,FREE:1},t.TEAM_MEMBERSHIP_TYPE_LABELS={},t.TEAM_MEMBERSHIP_TYPE_LABELS[t.TEAM_MEMBERSHIP_TYPES.FREE]=a.intl.formatMessage({id:"zuqnRM",defaultMessage:"Limited"}),t.TEAM_MEMBERSHIP_TYPE_LABELS[t.TEAM_MEMBERSHIP_TYPES.FULL]=a.intl.formatMessage({id:"ELKKjB",defaultMessage:"Full"}),t.TEAM_JOIN_REQUEST_STATE={DISCOVERY_DISABLED:1,CAN_AUTO_JOIN:3,APPROVAL_REQUIRED:4,WAITING_FOR_APPROVAL:5,REQUEST_APPROVED:6,REQUEST_REJECTED_OPEN:7,REQUEST_REJECTED_DISMISSED:8},t.REQUEST_MEMBERSHIP_POLICY_VALUES={REQUIRE_APPROVAL:0,AUTO_ACCEPT:1,DISABLED:2},t.REQUEST_MEMBERSHIP_POLICY_VALUE_AS_STRING=((s={})[t.REQUEST_MEMBERSHIP_POLICY_VALUES.REQUIRE_APPROVAL]="require_approval",s[t.REQUEST_MEMBERSHIP_POLICY_VALUES.AUTO_ACCEPT]="auto_accept",s[t.REQUEST_MEMBERSHIP_POLICY_VALUES.DISABLED]="disabled",s),t.REQUEST_MEMBERSHIP_POLICY_VALUE_LIST=[t.REQUEST_MEMBERSHIP_POLICY_VALUES.REQUIRE_APPROVAL,t.REQUEST_MEMBERSHIP_POLICY_VALUES.AUTO_ACCEPT,t.REQUEST_MEMBERSHIP_POLICY_VALUES.DISABLED],t.MEMBER_SEND_INVITE_POLICY_VALUES={DISABLED:0,SPECIFIC_MEMBERS:1,EVERYONE:2},t.MEMBER_SEND_INVITE_POLICY_VALUE_AS_STRING=((i={})[t.MEMBER_SEND_INVITE_POLICY_VALUES.EVERYONE]="everyone",i[t.MEMBER_SEND_INVITE_POLICY_VALUES.SPECIFIC_MEMBERS]="specific_members",i[t.MEMBER_SEND_INVITE_POLICY_VALUES.DISABLED]="disabled",i),t.MEMBER_SEND_INVITE_POLICY_VALUE_FROM_STRING={everyone:t.MEMBER_SEND_INVITE_POLICY_VALUES.EVERYONE,specific_members:t.MEMBER_SEND_INVITE_POLICY_VALUES.SPECIFIC_MEMBERS,disabled:t.MEMBER_SEND_INVITE_POLICY_VALUES.DISABLED},t.MEMBER_SEND_INVITE_POLICY_VALUE_LIST=[t.MEMBER_SEND_INVITE_POLICY_VALUES.EVERYONE,t.MEMBER_SEND_INVITE_POLICY_VALUES.SPECIFIC_MEMBERS,t.MEMBER_SEND_INVITE_POLICY_VALUES.DISABLED],t.REQUEST_MEMBERSHIP_POLICY_STRINGS={},t.REQUEST_MEMBERSHIP_POLICY_STRINGS[t.REQUEST_MEMBERSHIP_POLICY_VALUES.REQUIRE_APPROVAL]={LABEL:a.intl.formatMessage({id:"k8RbN0",defaultMessage:"By Request"}),DESCRIPTION:a.intl.formatMessage({id:"h8DYhc",defaultMessage:"They can see it and ask to join"})},t.REQUEST_MEMBERSHIP_POLICY_STRINGS[t.REQUEST_MEMBERSHIP_POLICY_VALUES.AUTO_ACCEPT]={LABEL:a.intl.formatMessage({id:"z5t3Bh",defaultMessage:"Open"}),DESCRIPTION:a.intl.formatMessage({id:"sa8acb",defaultMessage:"They can see it and join on their own"})},t.REQUEST_MEMBERSHIP_POLICY_STRINGS[t.REQUEST_MEMBERSHIP_POLICY_VALUES.DISABLED]={LABEL:a.intl.formatMessage({id:"Tj12s5",defaultMessage:"Invite-only"}),DESCRIPTION:a.intl.formatMessage({id:"84r4yx",defaultMessage:"They can join by invite only"})},t.NOTES_LINK_POLICY_VALUES={TEAM:0,PUBLIC:1},t.NOTES_LINK_POLICY_LABELS={},t.NOTES_LINK_POLICY_LABELS[t.NOTES_LINK_POLICY_VALUES.TEAM]=a.intl.formatMessage({id:"QMTnUm",defaultMessage:"Just people on my team with the link"}),t.NOTES_LINK_POLICY_LABELS[t.NOTES_LINK_POLICY_VALUES.PUBLIC]=a.intl.formatMessage({id:"ini0mY",defaultMessage:"Anyone with the link"}),t.SETUP_WIZARD_STEP={EXISTING_TEAM:0,PROVISION:10,TEAM_FOLDER:20,FINISHING_UP:30,COMPLETED:100},t.TEAM_PROMO_STEPS={WELCOME:1,VERIFY_EMAIL:2,JOIN_EXISTING:3,CHOOSE_TEAM_NAME:4,CHOOSE_SETUP_TYPE:5,CREATE_COMPLETE:6,REQUEST_SUBMITTED:7}})),define("modules/clean/teams/new_limited_team_create_form",["require","exports","tslib","create-react-class","purify","react","react-addons-linked-state-mixin","react-transition-group","react-dom-factories","external/lodash","modules/clean/ajax","modules/clean/analytics","modules/clean/components/title_bubble","modules/clean/react/button","modules/clean/react/input","modules/clean/react/radio","modules/clean/teams/constants","modules/core/browser","modules/core/i18n","modules/core/notify","modules/core/uri"],(function(e,t,a,s,i,r,o,n,l,m,u,d,p,c,_,f,E,g,h,M,T){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),s=a.__importDefault(s),i=a.__importStar(i),r=a.__importDefault(r),o=a.__importDefault(o),l=a.__importDefault(l),m=a.__importStar(m),u=a.__importStar(u),p=a.__importDefault(p),c=a.__importStar(c),_=a.__importStar(_),g=a.__importStar(g);var b=r.default.createElement,S=_.text,I=_.password,N=c.button;t.default=s.default({mixins:[o.default],displayName:"NewLimitedTeamCreateForm",getDefaultProps:function(){return{defaultMigrationType:"work",isMaestroDesign:!1}},getInitialState:function(){return{teamName:"",migrationType:this.props.defaultMigrationType,email:"",password:"",tosChecked:!1,errors:{},serverErrors:{},submitting:!1}},componentDidUpdate:function(){return this._updateErrors()},_getErrors:function(){var e={};return 0!==this.state.teamName.trim().length||this.props.isMaestroDesign||(e.team_name={message_text:h.intl.formatMessage({id:"CuyVFV",defaultMessage:"Please enter a company name"})}),"personal"===this.state.migrationType&&(0===this.state.email.trim().length&&(e.email={message_text:h.intl.formatMessage({id:"I7g4FQ",defaultMessage:"Please enter an email address"})}),0===this.state.password.trim().length&&(e.password={message_text:h.intl.formatMessage({id:"LhlWCW",defaultMessage:"Please enter a password"})}),this.props.isMaestroDesign||this.state.tosChecked||(e.tos_agree={message_text:h.intl.formatMessage({id:"S+JnfP",defaultMessage:"Please check the box to continue"})})),e},_updateErrors:function(){var e=this._getErrors(),t=m.omitBy(this.state.errors,(function(t,a){return!(a in e)}));if(!m.isEqual(this.state.errors,t))return this.setState({errors:t})},_onCTAClick:function(e){var t=this;if(e.preventDefault(),!this.state.submitting){var a=this._getErrors();if(this.setState({errors:a}),m.isEmpty(a)){this.setState({submitting:!0,serverErrors:{}});var s=function(e,a,s){if(t.setState({submitting:!1}),"rate-limit"!==e.getResponseHeader("x-dropbox-app-error")){var i;try{i=JSON.parse(s)}catch(e){i={}}t._logErrors(i),null!=i.email&&[i.email.message_text,i.email.message_html].includes("email-taken")&&(i.email.message_text=h.intl.formatMessage({id:"AnTrsf",defaultMessage:"This e-mail is already taken."})),t.setState({serverErrors:i})}else M.Notify.error(h.intl.formatMessage({id:"+K1hcW",defaultMessage:"You can’t create more than two teams per user account. Please reach out to support if you’d like to create a new team."}))};return this.props.personalUser.email===this.state.email?((a={email:{}}).email.message_text=h.intl.formatMessage({id:"9qaTn3",defaultMessage:"You’re already signed in!"}),void this.setState({submitting:!1,serverErrors:a})):this.props.isMaestroDesign?void("personal"===this.state.migrationType?u.WebRequest({url:"/register_for_team_creation",data:{team_name:"My New Team",email:this.state.email,password:this.state.password,fname:this.props.personalUser.fname,lname:this.props.personalUser.lname,tos_agree:!0},success:function(){return t.props.onSuccess({email:t.state.email,migrationType:t.state.migrationType},t.state.migrationType)},error:s}):"work"===this.state.migrationType&&this.props.onSuccess(this.state)):"work"===this.state.migrationType?u.WebRequest({url:"/team/create_limited",data:{team_name:this.state.teamName,tos_agree:!0,request_membership_policy:E.REQUEST_MEMBERSHIP_POLICY_VALUES.AUTO_ACCEPT,show_onboarding_on_team_creation:this.props.showOnboardingOnTeamCreation,_tk:g.get_uri().path},success:function(e){return t.props.onSuccess?"function"==typeof t.props.onSuccess?t.props.onSuccess(JSON.parse(e)):void 0:g.redirect(new T.URI({path:"/team",query:{team_created:"1"}}))},error:s}):u.WebRequest({url:"/register_for_team_creation",data:{team_name:this.state.teamName,email:this.state.email,password:this.state.password,fname:this.props.personalUser.fname,lname:this.props.personalUser.lname,tos_agree:this.state.tosChecked},success:function(){return g.redirect("/verify_email_for_team_creation?email="+encodeURIComponent(t.state.email))},error:s})}this._logErrors(a)}},_logErrors:function(e){e=m.mapValues(e,(function(e){return e.message_text}));var t=Object.keys(e).length;t>0&&"work"!==this.state.migrationType&&(e.error_count=t,d.TeamsWebActionsLogger.log("create_new_team_dropbox_error",e),"email-taken"===e.email&&d.TeamsWebActionsLogger.log("entered_existing_account_info"))},_onKeyPress:function(e){if("Enter"===e.key)return this._onCTAClick(e)},_renderError:function(e){var t=(null!=this.state.errors[e]?this.state.errors[e].message_text:void 0)||(null!=this.state.serverErrors[e]?this.state.serverErrors[e].message_text:void 0);return t||null==(null!=this.state.serverErrors[e]?this.state.serverErrors[e].message_html:void 0)||(t=l.default.span({dangerouslySetInnerHTML:{__html:i.sanitize(null!=this.state.serverErrors[e]?this.state.serverErrors[e].message_html:void 0)}})),b(n.CSSTransition,{classNames:"form-error",in:!!t,timeout:100},l.default.div({className:"form-error",title:t},t))},_renderTeamNameForm:function(){return l.default.div({className:"team-name-form"},l.default.label({htmlFor:"team_name_input",className:"team-name-form__label"},h.intl.formatMessage({id:"XU/pE0",defaultMessage:"Team Name"})),this._renderError("team_name"),b(S,{valueLink:this.linkState("teamName"),className:"team-name-form__input",placeholder:h.intl.formatMessage({id:"UXY8eq",defaultMessage:"Company or organization name"}),"disable-errors":!0,autofocus:!0,id:"team_name_input",onKeyPress:this._onKeyPress}))},_renderSignupForm:function(){return l.default.div({key:"signup-form",className:"signup-form"},l.default.div({className:"signup-form-input"},this._renderError("email"),b(S,{valueLink:this.linkState("email"),className:"signup-form-input__email",placeholder:h.intl.formatMessage({id:"y3HyBT",defaultMessage:"Enter work email"}),"disable-errors":!0,inline:!0,onKeyPress:this._onKeyPress})),l.default.div({className:"signup-form-input"},this._renderError("password"),b(I,{valueLink:this.linkState("password"),className:"signup-form-input__password",placeholder:h.intl.formatMessage({id:"i+PJQ7",defaultMessage:"Password"}),"disable-errors":!0,inline:!0,measureStrength:!0,onKeyPress:this._onKeyPress})),this.props.isMaestroDesign?l.default.div({className:"signup-form__tos-message"},h.intl.formatMessage({id:"BgW2vl",defaultMessage:"Your use of Dropbox is governed by the <termsLink>Dropbox Terms</termsLink>"},{termsLink:function(e){return l.default.a({href:"/terms",target:"_blank"},e)}})):l.default.div({className:"signup-form__tos"},this._renderError("tos_agree"),l.default.input({checkedLink:this.linkState("tosChecked"),className:"signup-form__tos-checkbox",type:"checkbox",id:"signup-form__tos-checkbox"}),l.default.label({htmlFor:"signup-form__tos-checkbox",className:"signup-form__tos-label"},h.intl.formatMessage({id:"YKt3xS",defaultMessage:"I agree to <termsLink>Dropbox Terms</termsLink>"},{termsLink:function(e){return l.default.a({href:"/terms",target:"_blank"},e)}}))))},getMigrationTypeValueLink:function(){var e=this;return{value:this.state.migrationType,requestChange:function(t){if(t!==e.state.migrationType)return d.TeamsWebActionsLogger.log("onboarding_creation_select_migration_option",{migration_type:t}),e.setState({migrationType:t})}}},workRadioItem:function(e){var t;return t=this.props.isMaestroDesign?{title:h.intl.formatMessage({id:"OlBPrS",defaultMessage:"Convert my Dropbox account into a work Dropbox account"}),description:h.intl.formatMessage({id:"IOvzuh",defaultMessage:"All of your files will stay private until you choose to share them. If you use this Dropbox account for personal stuff, choose ‘Add a new Work Dropbox account’."})}:{title:h.intl.formatMessage({id:"LtpyWX",defaultMessage:"Make my current Dropbox a Team Dropbox"}),description:h.intl.formatMessage({id:"6QKHqF",defaultMessage:"All of your files will remain with “{user_email}”, and will stay private until you choose to share them. If you use this Dropbox mostly for personal stuff, choose “Create a new Team Dropbox.”"},{user_email:e.email}),title_bubble:h.intl.formatMessage({id:"ANAQWo",defaultMessage:"Converting your current Dropbox ({user_email}) to a Team Dropbox allows you to more easily share with teammates and organize company files. You will still have full ownership over your account. As the team creator, only you will have have admin permissions and are the only person who can upgrade the team to Dropbox Business."},{user_email:e.email}),bubble_direction:"east"},b(f.RadioItem,{value:"work",key:"work-option"},l.default.div({className:"migration-option"},l.default.h3({className:"migration-option__title"},t.title),l.default.div({className:"migration-option__description"},t.description,null!=t.title_bubble?[" ",b(p.default,{text:t.title_bubble,direction:t.bubble_direction},l.default.span({className:"migration-option__learn-more"},h.intl.formatMessage({id:"gk12sS",defaultMessage:"Learn more"})))]:void 0)))},personalRadioItem:function(e){var t;return t=this.props.isMaestroDesign?{title:h.intl.formatMessage({id:"cV9U52",defaultMessage:"Add a new work Dropbox account"}),description:h.intl.formatMessage({id:"1IPaeE",defaultMessage:"Keep your work stuff separate by creating a work Dropbox account with 2GB of free space under a new account. You can move any files from your current Dropbox account [{user_email}] after you set up your new work Dropbox account."},{user_email:e.email})}:{title:h.intl.formatMessage({id:"zkpujl",defaultMessage:"Create a new Team Dropbox"}),description:h.intl.formatMessage({id:"UKEOcd",defaultMessage:"Keep your work and personal files separate by creating a new Team Dropbox. You can move any files from your current Dropbox [{user_email}] after you set up your new Team Dropbox."},{user_email:e.email})},b(f.RadioItem,{value:"personal",key:"personal-option"},l.default.div({className:"migration-option"},l.default.h3({className:"migration-option__title"},t.title),l.default.div({className:"migration-option__description"},t.description," "),b(n.CSSTransition,{classNames:"signup-form",timeout:{appear:0,enter:500,exit:300},in:"personal"===this.state.migrationType,unmountOnExit:!0,mountOnEnter:!0},this._renderSignupForm())))},renderMaestro:function(e){return e=this.props.personalUser,l.default.div({className:"new-limited-team-create-form"},l.default.div({className:"account-migration-form"},b(f.RadioGroup,{variant:f.RadioItemVariant.Large,align:"top",legend:h.intl.formatMessage({id:"25+Unl",defaultMessage:"Account migration options."}),valueLink:this.getMigrationTypeValueLink()},"work"===this.props.defaultMigrationType?[this.workRadioItem(e),this.personalRadioItem(e)]:[this.personalRadioItem(e),this.workRadioItem(e)])),l.default.div({className:"cta-form"},b(N,{className:"cta-form__button",onClick:this._onCTAClick,disabled:this.state.submitting},"personal"===this.state.migrationType?h.intl.formatMessage({id:"dABmX9",defaultMessage:"Add work Dropbox account"}):h.intl.formatMessage({id:"ulh0r7",defaultMessage:"Create work Dropbox account"}))))},renderOriginal:function(e){return l.default.div({className:"new-limited-team-create-form"},this._renderTeamNameForm(),l.default.div({className:"account-migration-form"},b(f.RadioGroup,{variant:f.RadioItemVariant.Large,align:"top",legend:h.intl.formatMessage({id:"25+Unl",defaultMessage:"Account migration options."}),valueLink:this.getMigrationTypeValueLink()},"personal"===this.props.defaultMigrationType?[this.personalRadioItem(e),this.workRadioItem(e)]:[this.workRadioItem(e),this.personalRadioItem(e)])),l.default.hr(),l.default.div({className:"cta-form"},b(N,{className:"cta-form__button",onClick:this._onCTAClick,disabled:this.state.submitting},"personal"===this.state.migrationType?h.intl.formatMessage({id:"LgJiOW",defaultMessage:"Continue"}):h.intl.formatMessage({id:"lP5fOl",defaultMessage:"Create Team Dropbox"}))))},render:function(){var e=this.props.personalUser;return this.props.isMaestroDesign?this.renderMaestro(e):this.renderOriginal(e)}})})),define("modules/clean/teams/team_choose",["require","exports","tslib","classnames","external/lodash","react","react-transition-group","modules/clean/analytics","modules/clean/em_string","modules/clean/react/button","modules/clean/react/image","modules/clean/react/title_bubble","modules/clean/static_urls","modules/clean/teams/constants","modules/clean/viewer","modules/constants/trademark","modules/core/i18n","modules/clean/metrics/index","modules/clean/react/teams/team_discovery/data/logger","modules/core/uri"],(function(e,t,a,s,i,r,o,n,l,m,u,d,p,c,_,f,E,g,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),s=a.__importDefault(s),i=a.__importStar(i),r=a.__importDefault(r),m=a.__importStar(m);var M=(c=a.__importStar(c)).TEAM_JOIN_REQUEST_STATE,T=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.render=function(){var e,t,a=this.props.joinableTeams.slice(),s=[];null!=this.props.joinableTeams[0]&&this.props.joinableTeams[0].is_invite&&(s=this.props.joinableTeams.slice(0,1),a=a.slice(1));for(var i=0;i<a.length;i++){var o=a[i];if(o.join_request_state===M.REQUEST_APPROVED){s.push(o),a.splice(i,1);break}}return s.length>0&&(e=r.default.createElement(b,{origin:"team",cancelJoinTeamHandler:this.props.cancelJoinTeamHandler,joinableTeams:s,joinTeamHandler:this.props.joinTeamHandler,showTeamTypeLabels:this.props.showTeamTypeLabels,title:E.intl.formatMessage({id:"QbnF94",defaultMessage:"{count, plural, one{Team invitation} other{Team invitations}}"},{count:s.length}),className:"invited-section"})),a.length>0&&(t=r.default.createElement(b,{origin:"team",cancelJoinTeamHandler:this.props.cancelJoinTeamHandler,joinableTeams:a,joinTeamHandler:this.props.joinTeamHandler,showTeamTypeLabels:this.props.showTeamTypeLabels,title:E.intl.formatMessage({id:"gbg3JH",defaultMessage:"{count, plural, one{Team you can join} other{Teams you can join}}"},{count:a.length})})),r.default.createElement("div",null,e,t)},t})(r.default.Component);t.TeamChooseWidget=T;var b=(function(e){function t(t){var a=e.call(this,t)||this;a.showMoreOnClick=function(){a.setState({expanded:!0}),n.TeamsWebActionsLogger.log("click_expand")};for(var s=a.props.joinableTeams,i=[],r=[M.WAITING_FOR_APPROVAL,M.REQUEST_APPROVED,M.REQUEST_REJECTED_OPEN],o=0,l=s;o<l.length;o++){var m=l[o];r.includes(m.join_request_state)?i.unshift(m.team_id):i.push(m.team_id)}return a.state={teamSortOrder:i,expanded:!1},a}return a.__extends(t,e),t.prototype.componentWillReceiveProps=function(e){if(e.joinableTeams){var t=i.keyBy(e.joinableTeams,"team_id"),a=i.filter(this.state.teamSortOrder,(function(e){return!!t[e]}));a=i.uniq(a.concat(i.map(t,(function(e){return e.team_id})))),this.setState({teamSortOrder:a})}},t.prototype.componentDidMount=function(){this.logComponentRendered()},t.prototype.logComponentRendered=function(){var e=this.props.origin;null==e&&(e="unknown");var t={origin:e},a=g.getMetricsReporter().child(t).createCounter({ns:h.AMPNamespace.TEAM_DISCOVERY,name:"web/team_choose_list/component/rendered"});a.increment(1),a.record()},t.prototype.getSortedJoinableTeams=function(){var e=i.keyBy(this.props.joinableTeams,"team_id");return i.map(this.state.teamSortOrder,(function(t){return e[t]}))},t.prototype.renderShowMore=function(e){return r.default.createElement("li",{className:"team-list-show-more"},r.default.createElement("span",{className:"team-list-show-more-button",onClick:this.showMoreOnClick},E.intl.formatMessage({id:"z2MCOp",defaultMessage:"{count, plural, one{View {count} more} other{View {count} more}}"},{count:e})))},t.prototype.render=function(){var e=this.state.expanded,t=this.props,a=t.buttonImportance,s=t.cancelJoinTeamHandler,i=t.className,n=t.ctaNewTeamImportance,l=t.disableButtons,m=t.teamRowHighlight,d=t.hasTeamPendingApproval,c=t.initialNumTeamsToShow,_=t.joinTeamHandler,f=t.maxNamesToShow,g=t.showBusinessTeamIcon,h=t.showJoinTextForInvite,M=t.showTeamTypeLabels,T=t.staticRows,b=t.title,N=0;T&&c?N=Math.max(0,c-T.length):c&&(N=Math.max(0,c));var v,y,P=this.getSortedJoinableTeams().map((function(e){return r.default.createElement(I,{team:e,cancelJoinTeamHandler:s,joinTeamHandler:_,key:e.team_id,showBusinessTeamIcon:g,buttonImportance:a,maxNamesToShow:f,showTeamTypeLabels:M,disableButton:l,showJoinTextForInvite:h,teamRowHighlight:m,hasTeamPendingApproval:d})})),R=P,A=null,L=[];return P.length>N&&(R=P.slice(0,N),e?L=P.slice(N):A=this.renderShowMore(P.length-N)),T&&T.forEach((function(t){var a=r.default.createElement(u.Image,{src:p.static_url("/static/images/teams/add_cir-vfl6sl23s.png"),srcHiRes:p.static_url("/static/images/teams/add_cir@2x-vflGMnZ12.png")}),s=r.default.createElement(S,{icon:a,title:t.title||E.intl.formatMessage({id:"zkpujl",defaultMessage:"Create a new Team Dropbox"}),subtitle:t.subtitle,actionText:t.actionText||E.intl.formatMessage({id:"bhV8Xa",defaultMessage:"Create"}),actionHandler:t.actionHandler,disableButton:l,importance:n});e?L.push(s):R.push(s)})),L&&(y=r.default.createElement(o.CSSTransition,{classNames:"team-list-show-more-section",appear:!1,enter:!0,exit:!0,timeout:{appear:0,enter:300,exit:300},unmountOnExit:!0},r.default.createElement("div",{className:"team-list-show-more-section"},L))),P.length>N&&(v=r.default.createElement(o.TransitionGroup,null,y)),r.default.createElement("div",{className:i},b&&b.length>0?r.default.createElement("div",{className:"team-list-title"},b):void 0,r.default.createElement("ol",{className:"team-list-view"},R,A,v))},t.defaultProps={maxNamesToShow:3,initialNumTeamsToShow:3,staticRows:[],disableButtons:!1},t})(r.default.Component);t.TeamJoinList=b;var S=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.render=function(){return r.default.createElement("li",{className:"team-list-item",key:this.props.title+this.props.subtitle},r.default.createElement("div",{className:"team-list-item-contents"},r.default.createElement("div",{className:"team-list-avatars"},r.default.createElement("div",{className:"team-list-item__custom-img u-mar-right-s"},this.props.icon)),r.default.createElement("div",{className:"team-list-item-body"},r.default.createElement("div",{className:"team-list-item-text team-list-item-title"},this.props.title),r.default.createElement("span",{className:"team-list-item-text team-list-item-subtitle"},this.props.subtitle)),r.default.createElement("div",{className:"team-list-item-actions"},r.default.createElement(m.button,{importance:this.props.importance||"primary",disabled:this.props.disableButton,onClick:this.props.actionHandler},this.props.actionText)),r.default.createElement("div",{className:"clear"})))},t})(r.default.Component),I=(function(e){function t(t){var a=e.call(this,t)||this;return a.renderActionItemOnClick=function(){var e=a.props.team;a.props.cancelJoinTeamHandler(e)},a.formatDate=function(e){return E.intl.formatDate(e,{year:"numeric",month:"long",day:"numeric"})},a.state=a.getInitialState(),a}return a.__extends(t,e),t.prototype.componentDidUpdate=function(e,t){!0===t.submit&&this.setState(this.getInitialState())},t.prototype.getInitialState=function(){return{submit:!1}},t.prototype.isPendingState=function(e){return[M.WAITING_FOR_APPROVAL,M.REQUEST_REJECTED_OPEN].includes(e)},t.prototype.getCtaButton=function(e,t){var a=this.props,s=a.disableButton,i=a.hasTeamPendingApproval,o=a.showJoinTextForInvite,n=a.team,l=this.state.submit,u="",d=!1;return n.is_invite||n.join_request_state===M.REQUEST_APPROVED?o?(u=E.intl.formatMessage({id:"4NcxQ9",defaultMessage:"Join"}),d=l||s):(u=E.intl.formatMessage({id:"9B0qpj",defaultMessage:"Accept Invitation"}),d=l||s):this.isPendingState(n.join_request_state)?(u=E.intl.formatMessage({id:"h4OU3d",defaultMessage:"Asked to join"}),d=!0,e="tertiary"):n.join_request_state===M.APPROVAL_REQUIRED?(u=E.intl.formatMessage({id:"1l72c9",defaultMessage:"Request to join"}),d=l||s):n.join_request_state===M.CAN_AUTO_JOIN&&(u=E.intl.formatMessage({id:"4NcxQ9",defaultMessage:"Join"}),d=l||s),i&&(d=d||n.join_request_state!==M.WAITING_FOR_APPROVAL),r.default.createElement(m.button,{importance:e,onClick:t,children:u,disabled:d})},t.prototype.renderActionItem=function(){var e=this,t=this.props,a=t.buttonImportance,s=t.joinTeamHandler,i=t.team;if(this.isPendingState(i.join_request_state)){if(i.join_request_state===M.WAITING_FOR_APPROVAL){var o=void 0;if(i.join_request_date){var n=this.formatDate(i.join_request_date);o=E.intl.formatMessage({id:"GOzuO6",defaultMessage:"Requested on {request_date}"},{request_date:n})}else o=E.intl.formatMessage({id:"wmv2D+",defaultMessage:"Requested"});return r.default.createElement("div",{className:"cancel-request"},o,r.default.createElement("button",{onClick:this.renderActionItemOnClick,className:"button-as-link cancel-request__link"},E.intl.formatMessage({id:"hIN6IW",defaultMessage:"Cancel request"})))}var l=void 0;if(i.join_denied_date){var m=this.formatDate(i.join_denied_date);l=E.intl.formatMessage({id:"Crjkyu",defaultMessage:"Declined on {request_date}"},{request_date:m})}else l=E.intl.formatMessage({id:"TV9R9r",defaultMessage:"Request declined"});return r.default.createElement("div",{className:"declined-request"},l)}var u=a||"tertiary";return this.getCtaButton(u,(function(){s(i),e.setState({submit:!0})}))},t.prototype._generateMemberCountSpan=function(e){return r.default.createElement("span",{className:"team-list-item-text team-list-item-subtitle"},E.intl.formatMessage({id:"EWc63s",defaultMessage:"{count, plural, one{{count} member} other{{count} members}}"},{count:e}))},t.prototype.renderMembersSection=function(e){var t,a,s,i=this.props.maxNamesToShow;if(i||(i=0),e.is_private){var o=this._generateMemberCountSpan(e.num_members);return r.default.createElement("div",{className:"team-list-item-members-section"},o)}if(e.inviting_user_name){s="",e.members_to_display.forEach((function(e){s+=e.email+"\n"})),e.members_to_display.length<e.num_members&&(t=e.num_members-e.members_to_display.length,s+=E.intl.formatMessage({id:"N9K17w",defaultMessage:"and {extra} more"},{extra:t}));var n=_.Viewer.get_viewer().personal_email!==e.inviting_user_email;return r.default.createElement("div",{className:"team-list-item-members-section"},n&&r.default.createElement(r.default.Fragment,null,r.default.createElement(d.TitleBubble,{content:e.inviting_user_email||e.inviting_user_name,key:"invitee-name",position:d.TitleBubble.POSITIONS.BOTTOM,distanceFromTarget:8},r.default.createElement("span",{className:"team-list-item-text team-list-item-invitee-name"},l.Emstring.em_snippet(E.intl.formatMessage({id:"5uOM5W",defaultMessage:"Invited by {admin_name}"},{admin_name:e.inviting_user_name}),30))),r.default.createElement("span",{className:"u-pad-xxs",key:"middle-dot"},E.intl.formatMessage({id:"H98NkM",defaultMessage:"·"}))),r.default.createElement(d.TitleBubble,{content:s,position:d.TitleBubble.POSITIONS.BOTTOM,distanceFromTarget:8,key:"title-bubble",className:"white-space-wrap"},this._generateMemberCountSpan(e.num_members)))}var m="";s="";for(var u=0;u<e.members_to_display.length;u++)a=e.members_to_display[u],u>i-1?s+=a.email+"\n":u===e.members_to_display.length-1?[0,i-1].includes(u)?m+=""+a.display_name:m+=E.intl.formatMessage({id:"Rzcq8W",defaultMessage:"and {display_name}"},{display_name:a.display_name}):m+=a.display_name+", ";return e.members_to_display.length<e.num_members&&(t=e.num_members-e.members_to_display.length,s+=E.intl.formatMessage({id:"N9K17w",defaultMessage:"and {extra} more"},{extra:t})),s?r.default.createElement("div",{className:"team-list-item-members-section"},r.default.createElement("span",{className:"team-member-names",key:"team-member-names"}," ",m),r.default.createElement(d.TitleBubble,{content:s,position:d.TitleBubble.POSITIONS.BOTTOM,distanceFromTarget:8,key:"title-bubble",className:"white-space-wrap"},r.default.createElement("span",null,E.intl.formatMessage({id:"VYioi5",defaultMessage:"{count, plural, one{and {count} more} other{and {count} more}}"},{count:e.num_members-i})))):r.default.createElement("span",{className:"team-list-item-members-section team-member-names"},m)},t.prototype.renderTeamLabel=function(e){if(this.props.showTeamTypeLabels&&this.props.showBusinessTeamIcon&&!e.is_limited){var t=r.default.createElement("div",{className:"business-team-tooltip__content"},r.default.createElement("div",{className:"tooltip-bold-text u-mar-bottom-xxs"},E.intl.formatMessage({id:"DHafRJ",defaultMessage:"{trademark_business} account"},{trademark_business:f.TRADEMARK_BUSINESS})),r.default.createElement("div",{className:"tooltip-normal-text"},E.intl.formatMessage({id:"MgS8Ue",defaultMessage:"{team_name} owns and administers this Dropbox"},{team_name:e.team_name})));return r.default.createElement("span",{className:"business-team-tooltip__icon-container"},r.default.createElement(d.TitleBubble,{content:t,position:d.TitleBubble.POSITIONS.RIGHT,distanceFromTarget:12},r.default.createElement(u.Image,{src:p.static_url("/static/images/teams/building_icon-vflqiltW_.png"),srcHiRes:p.static_url("/static/images/teams/building_icon@2x-vflxby4HL.png"),alt:E.intl.formatMessage({id:"U5kP2t",defaultMessage:"Business team icon"}),className:"business-team-icon"})))}},t.prototype.render=function(){var e=this.props,t=e.team,a=e.teamRowHighlight,i={"is-inviting-team":t.is_invite||t.join_request_state===M.REQUEST_APPROVED,"team-list-item--highlighted":a},o=this.renderMembersSection(t);return r.default.createElement("li",{className:s.default("team-list-item",i)},r.default.createElement("div",{className:"team-list-item-contents"},r.default.createElement("div",{className:"team-list-item-body"},r.default.createElement("div",{className:"team-list-item-text team-list-item-title"},t.team_name,this.renderTeamLabel(t)),o),r.default.createElement("div",{className:"team-list-item-actions"},this.renderActionItem())),r.default.createElement("div",{className:"clear"}))},t})(r.default.Component)}));
//# sourceMappingURL=pkg-legacy-al.min.js-vfln55RbE.map