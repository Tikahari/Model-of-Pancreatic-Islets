define(["require","exports","tslib","react","modules/clean/bolt","modules/clean/react/growth/continuous_onboarding/continuous_onboarding_reducer","modules/clean/react/growth/continuous_onboarding/utils","modules/core/browser_detection","modules/clean/api_v2/user_client"],(function(e,n,t,o,i,r,s,u,a){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),o=t.__importDefault(o),n.webSidebarArgs={surface:{".tag":"web_sidebar"}};var c=function(e,t){return(new a.UserApiV2Client).ns("growth").rpc("get_continuous_onboarding",n.webSidebarArgs,{subjectUserId:e}).then(t)},l=function(e,n,t,o){var s,u=Object.keys(o).map((function(e){var n=o[e],t=n.unique_id,r=n.revision,s=n.token;return new i.SignedChannelState(e,t,r,s)}));if(u.length){return(s=new i.BoltClient(u,(function(o){var i=o[0].app_id;e.logBoltNotification(i),c(t,(function(e){var t=e.progression,o=e.bolt_channel_states;t&&n({type:r.Actions.BOLT_SIDEBAR_UPDATE,progression:t,bolt_channel_states:o})}))}),(function(){s.unsubscribe(),c(t,(function(o){var i=o.bolt_channel_states;l(e,n,t,i)}))}))).start(),s}};n.useSidebarInitialization=function(e,n,t,i){var a=o.default.useState(0),d=a[0],f=a[1];o.default.useEffect((function(){u.is_supported_mobile_browser()||c(t,(function(o){var i=o.progression,u=o.display_surface_props,a=o.bolt_channel_states;if(i&&i.module_ids.length){var c=u;s.markUnseenModulesAsSeen(i,t);var d=l(e,n,t,a);if(n({type:r.Actions.SET_SIDEBAR,progression:i,display_surface_props:c,bolt_channel_states:a}),e.setProject(i.progression_id),c.open_on_load&&i.module_ids.length){var _=setTimeout((function(){n({type:r.Actions.OPEN_SIDEBAR}),f(0)}),500);f(_)}return function(){d&&d.unsubscribe()}}}))}),[]),o.default.useEffect((function(){d&&i&&(n({type:r.Actions.FORCE_CLOSE}),clearTimeout(d),f(0))}),[i,d])},n.useActiveBackgroundChange=function(e,n,t){o.default.useEffect((function(){if(void 0!==t){var o=void 0;t?(o=r.Actions.FORCE_CLOSE,e.logSidebarAutoCollapsed()):(o=r.Actions.REOPEN_IF_CLOSED_BY_ACTIVE_BACKGROUND,e.logSidebarAutoExpanded()),n({type:o})}}),[t])},n.useExpandChange=function(e,t,i){n.useLogOnceWhenFirstTrue(e,"logSidebarViewed",t),o.default.useEffect((function(){i&&i(t)}),[t,i])},n.useComponentScroll=function(){var e=o.default.useState(!1),n=e[0],t=e[1];return{isScrolled:n,handleScroll:function(e){t(e.currentTarget.scrollTop>0)}}},n.useLogOnceWhenFirstTrue=function(e,n,t){var i=o.default.useState(!1),r=i[0],s=i[1];o.default.useEffect((function(){t&&!r&&(e[n](),s(!0))}),[t,e,n,r])}}));
//# sourceMappingURL=hooks.min.js-vflRkaP99.map